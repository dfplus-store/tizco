<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tizco Boutique</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#f5f5f5;}
header{background:#0f172a;color:#fff;padding:1rem;text-align:center;}
.controls{display:flex;gap:10px;padding:10px;justify-content:center;flex-wrap:wrap;}
.controls input, .controls select{padding:8px;border-radius:6px;border:1px solid #ccc;}
.catalog{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;padding:16px;}
.product{background:#fff;padding:12px;border-radius:12px;box-shadow:0 4px 12px rgba(0,0,0,.1);display:flex;flex-direction:column;transition:0.3s;}
.product img{width:100%;height:150px;object-fit:cover;border-radius:10px;}
.product h3{margin:10px 0 4px;font-size:1.1rem;}
.meta{color:#666;font-size:.85rem;margin-bottom:6px;}
.price{font-weight:bold;margin-bottom:6px;}
.qty-box{display:flex;gap:4px;align-items:center;margin-bottom:6px;}
.qty-box button{padding:4px 8px;cursor:pointer;}
.btn{background:#25d366;color:#fff;padding:8px;border:none;border-radius:6px;font-weight:bold;cursor:pointer;transition:0.2s;}
.btn:hover{background:#20b858;}
.cart-btn{position:fixed;bottom:20px;right:20px;background:#0f172a;color:#fff;padding:12px 16px;border-radius:50px;border:none;z-index:100;}
#cartSidebar{position:fixed;top:0;right:-400px;width:350px;height:100%;background:#fff;box-shadow:-4px 0 12px rgba(0,0,0,0.3);z-index:1000;padding:16px;overflow-y:auto;transition:0.3s;}
#cartSidebar.open{right:0;}
#cartBackdrop{position:fixed;inset:0;background:rgba(0,0,0,.2);display:none;z-index:900;}
#cartSidebar.open + #cartBackdrop{display:block;}
#deliveryAddress{width:100%;padding:8px;margin:8px 0;border-radius:6px;border:1px solid #ccc;}
</style>
</head>
<body>
<header>
  <h2>Tizco Boutique</h2>
  <p>Fashion & Footwear Accessories</p>
</header>
<div class="controls">
  <input id="search" placeholder="Search products..." onkeyup="filterProducts()">
  <select id="category" onchange="filterProducts()">
    <option value="all">All</option>
    <option value="dress">Dress</option>
    <option value="top">Top</option>
    <option value="footwear">Footwear</option>
  </select>
</div>
<section id="catalog" class="catalog"></section>
<button class="cart-btn" onclick="openCart()">üõí Cart (<span id="cartCount">0</span>)</button>
<div id="cartSidebar">
  <div id="cartBox">
    <h3>Your Cart</h3>
    <div id="cartItems"></div>
    <p id="cartTotal"></p>
    <label>Delivery Address:</label>
    <input id="deliveryAddress" placeholder="Enter your address">
    <button id="checkoutBtn" class="btn" onclick="checkoutWhatsApp()">Checkout on WhatsApp</button>
    <button onclick="continueShopping()" style="width:100%;">Continue Shopping</button>
    <button onclick="closeCart()" style="width:100%;">Close</button>
  </div>
</div>
<div id="cartBackdrop" onclick="closeCart()"></div>
<script>
const csvURL="products.csv";
const WHATSAPP_NUMBER="2348012345678";
const DELIVERY_FEE=2500;
let products=[],cart=[],productQty={};
function saveCart(){localStorage.setItem("tizco_cart",JSON.stringify(cart));}
function loadCart(){const saved=localStorage.getItem("tizco_cart");if(saved){cart=JSON.parse(saved);cartCount.innerText=cart.length;}}
function clearCart(){cart=[];localStorage.removeItem("tizco_cart");cartCount.innerText=0;}
fetch(csvURL).then(r=>r.text()).then(data=>{
  data.trim().split("\n").slice(1).forEach((r,idx)=>{
    const [id,name,category,brand,price,discount,size,color,stock,image]=r.split(",");
    products.push({id,name,category,brand,price:Number(price),discount:Number(discount)||0,size,color,stock:Number(stock),image});
    productQty[idx]=1;
  });
  displayProducts(products);
});
function displayProducts(list){
  catalog.innerHTML="";
  list.forEach((p,idx)=>{
    const finalPrice=p.discount>0?p.discount:p.price;
    const disabled=p.stock<=0?"disabled":"";
    const btnText=p.stock<=0?"Out of stock":"Add to Cart";
    catalog.innerHTML+=`
      <div class="product">
        <img src="${p.image}">
        <h3>${p.name}</h3>
        <div class="meta">${p.brand} ‚Ä¢ Size: ${p.size} ‚Ä¢ Color: ${p.color}</div>
        <div class="price">${p.discount>0? `<span style="text-decoration:line-through">‚Ç¶${p.price}</span> <span>‚Ç¶${p.discount}</span>` : "‚Ç¶"+p.price}</div>
        <div class="qty-box">
          <button onclick="changeProductQty(${idx},-1)">‚ûñ</button>
          <span id="qty-${idx}">${productQty[idx]}</span>
          <button onclick="changeProductQty(${idx},1)">‚ûï</button>
        </div>
        <button class="btn" onclick="addProductWithQty('${p.name}',${finalPrice},${idx})" ${disabled}>${btnText}</button>
      </div>`;
  });
}
function changeProductQty(index,delta){ productQty[index]+=delta; if(productQty[index]<1) productQty[index]=1; document.getElementById(`qty-${index}`).innerText=productQty[index];}
function addProductWithQty(name,price,index){
  const p=products[index];const qty=productQty[index];
  const item=cart.find(i=>i.name===p.name && i.size===p.size && i.color===p.color);
  if(item){if(item.qty+qty>p.stock){alert("Not enough stock");return;}item.qty+=qty;}
  else{cart.push({name:p.name,size:p.size,color:p.color,price,qty});}
  cartCount.innerText=cart.length; productQty[index]=1; document.getElementById(`qty-${index}`).innerText=1; saveCart();
}
function openCart(){
  let html="",subtotal=0;
  cart.forEach((i,idx)=>{const t=i.price*i.qty;subtotal+=t;html+=`<p>${i.name} | Size: ${i.size} | Color: ${i.color} | ‚Ç¶${i.price} x ${i.qty} = ‚Ç¶${t} <button onclick="removeItem(${idx})">‚ùå</button></p>`;});
  cartItems.innerHTML=html||"<p>Your cart is empty</p>";
  cartTotal.innerHTML=`Subtotal: ‚Ç¶${subtotal}<br>Delivery: ‚Ç¶${cart.length?DELIVERY_FEE:0}<br><b>Total: ‚Ç¶${subtotal+(cart.length?DELIVERY_FEE:0)}</b>`;
  document.getElementById("cartSidebar").classList.add("open");
}
function closeCart(){document.getElementById("cartSidebar").classList.remove("open");}
function continueShopping(){closeCart();catalog.scrollIntoView({behavior:"smooth"});}
function removeItem(idx){cart.splice(idx,1);cartCount.innerText=cart.length;saveCart();openCart();}
function checkoutWhatsApp(){
  if(cart.length===0) return;
  const address=deliveryAddress.value.trim();if(!address){alert("Enter delivery address");return;}
  const orderID="TIZ-"+Date.now();let msg=`Hello, I want to order.%0AOrder Ref: ${orderID}%0AAddress: ${address}%0A%0A`;let subtotal=0;
  cart.forEach((i,n)=>{const t=i.price*i.qty;subtotal+=t;msg+=`${n+1}. ${i.name} | Size: ${i.size} | Color: ${i.color} | Qty: ${i.qty} = ‚Ç¶${t}%0A%0A`;
  const prodIndex=products.findIndex(p=>p.name===i.name && p.size===i.size && p.color===i.color);if(prodIndex>=0){products[prodIndex].stock-=i.qty;if(products[prodIndex].stock<0)products[prodIndex].stock=0;}});
  msg+=`Subtotal: ‚Ç¶${subtotal}%0ADelivery: ‚Ç¶${DELIVERY_FEE}%0ATOTAL: ‚Ç¶${subtotal+DELIVERY_FEE}`;
  window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${msg}`,"_blank");
  clearCart(); closeCart(); displayProducts(products); saveCart();
}
function filterProducts(){const s=search.value.toLowerCase();const c=category.value;displayProducts(products.filter(p=>p.name.toLowerCase().includes(s)&&(c==="all"||p.category===c)));}
document.addEventListener("keydown",e=>{if(e.ctrlKey && e.altKey && e.key.toLowerCase()==="a"){const code=prompt("Admin access code");if(code==="TIZCO"){location.href="tizco-admin-9x72.html";}}});
window.onload=()=>{loadCart();}
</script>
</body>
</html>
